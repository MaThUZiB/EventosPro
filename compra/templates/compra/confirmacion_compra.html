{% extends 'core.html' %}
{% load static %}

{% block content %}
<section
  class="min-h-screen flex flex-col items-center justify-center text-center text-white relative overflow-hidden px-6">

  <!-- üåü Contenedor principal tipo cristal -->
  <div id="success-card"
    class="sc-card relative w-full max-w-lg rounded-3xl shadow-2xl overflow-hidden bg-white/5 backdrop-blur-3xl border border-white/20 p-10">

    <!-- üîπ Fondo de part√≠culas dentro del card -->
    <div class="absolute inset-0 pointer-events-none">
      <div class="w-full h-full bg-[radial-gradient(circle,rgba(255,255,255,0.05)_1px,transparent_1px)] 
                  bg-[length:10px_10px] animate-pulse-slow rounded-3xl"></div>
    </div>

    <!-- ‚úÖ √çcono animado -->
    <div class="flex justify-center mb-6 relative z-10">
      <div id="checkmark"
        class="sc-check w-16 h-16 rounded-full border-4 border-green-500 flex items-center justify-center bg-white/5 backdrop-blur-sm shadow-md">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8 text-green-500" fill="none" viewBox="0 0 24 24"
          stroke="currentColor" stroke-width="3">
          <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
        </svg>
      </div>
    </div>

    <!-- üßæ Texto principal -->
    <h1 class="sc-title text-3xl font-bold mb-4 relative z-10">¬°Compra realizada con √©xito!</h1>

    <div class="sc-meta space-y-2 mb-4 relative z-10">
      <p class="text-gray-300">Compra <span class="font-semibold text-white">#{{ compra.id }}</span></p>
      <p class="text-gray-300">Evento: <span class="font-semibold text-blue-400">{{
          compra.detalles.first.asiento.evento.nombre }}</span></p>
      <p class="text-gray-300">Total pagado: <span class="font-semibold text-green-400">${{ compra.total }}</span></p>
      <p class="text-gray-300">Ticket enviado a <span class="font-semibold text-red-400">{{ user.email }}</span></p>
    </div>

    <!-- üéüÔ∏è Lista de asientos -->
    <h3 class="sc-subtitle text-lg font-semibold mt-6 mb-2 text-gray-200 relative z-10">Asientos seleccionados</h3>
    <ul class="sc-list space-y-1 mb-6 relative z-10">
      {% for detalle in compra.detalles.all %}
      <li class="sc-list-item text-gray-300">üéüÔ∏è {{ detalle.nombre_asiento }}</li>
      {% endfor %}
    </ul>

    <span class="sc-method text-green-400 font-semibold block mb-6 relative z-10">Pago aprobado con {{ compra.pago.metodo }}</span>

    <!-- üîò Botones -->
    <div class="sc-buttons flex flex-col sm:flex-row items-center justify-center gap-4 relative z-10">
      <a href="{% url 'home' %}"
        class="sc-cta bg-blue-600/80 hover:bg-blue-700/90 text-white py-3 px-8 rounded-lg font-semibold inline-block transition transform hover:scale-105 shadow-lg">
        Volver a eventos
      </a>
      <a href="{% url 'compra:descargar_entrada' compra.id %}"
        class="sc-download bg-green-600/80 hover:bg-green-700/90 text-white py-3 px-8 rounded-lg font-semibold inline-block transition transform hover:scale-105 shadow-lg">
        Descargar entrada
      </a>
    </div>
  </div>

  <!-- üåÄ Animaciones GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const tl = gsap.timeline({ defaults: { ease: "power2.out" } });

      tl.from(".sc-card", { duration: 0.8, opacity: 0, y: 50, scale: 0.95 });
      tl.from(".sc-check", { duration: 0.5, scale: 0, rotate: -90, ease: "back.out(1.7)" }, "-=0.35");
      tl.from(".sc-title", { duration: 0.5, opacity: 0, y: 18 }, "-=0.2");
      tl.from(".sc-meta > *", { duration: 0.45, opacity: 0, y: 14, stagger: 0.08 }, "-=0.25");
      tl.from(".sc-subtitle", { duration: 0.4, opacity: 0, y: 15 }, "-=0.2");
      tl.from(".sc-list-item", { duration: 0.45, opacity: 0, y: 12, stagger: 0.06 }, "-=0.15");
      tl.from(".sc-method", { duration: 0.4, opacity: 0, y: 12 }, "-=0.15");
      tl.from(".sc-buttons", { duration: 0.5, opacity: 0, scale: 0.9, stagger: 0.15, ease: "back.out(1.5)" }, "-=0.1");
    });
  </script>
</section>
{% endblock %}